(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,a){e.exports=a(24)},21:function(e,t,a){},24:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(11),i=a.n(c),s=a(5),r=a(6),l=a(3),m=a(7),d=a(8),u=a(26),v=a(27),h=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={nome:"",cor:"#000000"},a.video=o.a.createRef(),a}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){e.video&&(e.video.current.srcObject=t,e.video.current.play())})}},{key:"render",value:function(){return o.a.createElement("div",{className:"Cadastro"},o.a.createElement("form",{className:"Form",onSubmit:this.onSubmit.bind(this)},o.a.createElement("div",{className:"Fields"},o.a.createElement("div",{className:"Field"},o.a.createElement("label",{className:"Legend"},"Digite o o seu Nome"),o.a.createElement("input",{type:"text",className:"Text",onChange:this.onChangeNome.bind(this),value:this.state.nome})),o.a.createElement("div",{className:"Field"},o.a.createElement("label",{className:"Legend"},"Selecione a sua cor"),o.a.createElement("input",{type:"color",className:"Color",onChange:this.onChangeCor.bind(this),value:this.state.cor})),o.a.createElement("div",{className:"Field"},o.a.createElement("input",{type:"submit",className:"Submit",value:"Continuar"})))),o.a.createElement("video",{className:"Video",ref:this.video,autoPlay:!0}))}},{key:"onSubmit",value:function(e){e.preventDefault(),this.props.history.push({pathname:"conferencia",state:{nome:this.state.nome,cor:this.state.cor}})}},{key:"onChangeNome",value:function(e){this.setState({nome:e.target.value})}},{key:"onChangeCor",value:function(e){this.setState({cor:e.target.value})}}]),t}(n.Component),E=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).elemento=o.a.createRef(),a}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentWillReceiveProps",value:function(){var e=this;this.props.inscricao.remoto&&(this.props.inscricao.remoto.ontrack=function(t){e.elemento.current.srcObject=t.streams[0],e.elemento.current.play()})}},{key:"render",value:function(){return o.a.createElement("video",{ref:this.elemento})}}]),t}(n.Component),p=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).video=o.a.createRef(),a.selecionado=o.a.createRef(),a.state={inscricoes:[]},a.state=Object.assign(a.state,a.props.location.state),""===a.state.nome||"undefined"===typeof a.state.nome?(a.props.history.push("cadastro"),Object(l.a)(a)):""===a.state.cor||"undefined"===typeof a.state.cor?(a.props.history.push("cadastro"),Object(l.a)(a)):(a.onSignaling(),a)}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){e.video.current.srcObject=t,e.video.current.play()})}},{key:"render",value:function(){var e=this,t=[];return this.state.inscricoes.forEach(function(a,n){t.push(o.a.createElement("div",{className:"Item",key:n,onClick:e.onSeleciona.bind(e,a.id)},o.a.createElement("div",{className:"Item-Video"},o.a.createElement(E,{inscricao:a})),o.a.createElement("div",{className:"Item-Descricao",style:{backgroundColor:"#"+a.cor}},o.a.createElement("div",{className:"Item-Nome"},a.nome))))}),o.a.createElement("div",{className:"Conferencia"},o.a.createElement("div",{className:"Video"},o.a.createElement("video",{ref:this.selecionado})),o.a.createElement("div",{className:"Convidados"},o.a.createElement("div",{className:"Fixado"},o.a.createElement("div",{className:"Item",onClick:this.onSeleciona.bind(this,this.state.id)},o.a.createElement("div",{className:"Item-Destaque-Portrait",style:{borderColor:"transparent "+this.state.cor+" transparent transparent"}}),o.a.createElement("div",{className:"Item-Destaque-Landscape",style:{borderColor:"transparent transparent transparent "+this.state.cor}}),o.a.createElement("div",{className:"Item-Video"},o.a.createElement("video",{ref:this.video})),o.a.createElement("div",{className:"Item-Descricao",style:{backgroundColor:this.state.cor}},o.a.createElement("div",{className:"Item-Nome"},this.state.nome)))),o.a.createElement("div",{className:"Dinamicos"},t)))}},{key:"onSeleciona",value:function(e){this.signaling.send(JSON.stringify({evento:"selecionado",id:e}))}},{key:"onSignaling",value:function(){var e=this,t=this.state.nome,a=this.state.cor.substring(1,this.state.cor.length),n="wss://"+(window.location.hostname||"localhost")+":8443?"+("nome="+t+"&cor="+a);this.signaling=new WebSocket(encodeURI(n)),this.signaling.onopen=function(){console.log("aberto")},this.signaling.onmessage=function(t){var a,n,o,c;console.log("recebido");var i=JSON.parse(t.data);switch(i.evento){case"identificacao":e.setState({id:i.id});break;case"criacao":n={id:i.id,nome:i.nome,cor:i.cor},(o=new RTCPeerConnection).onnegotiationneeded=function(){o.createOffer({offerToReceiveVideo:!0}).then(function(t){o.setLocalDescription(t).then(function(){e.signaling.send(JSON.stringify({evento:"oferta",oferta:t,id:n.id}))})})},o.onicecandidate=function(t){t.candidate&&e.signaling.send(JSON.stringify({evento:"candidato",id:n.id,candidato:t.candidate}))},navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){o.addStream(e)}),n.local=o,(a=e.state.inscricoes).push(n),e.setState({inscricoes:a});break;case"oferta":a=e.state.inscricoes,n=a.find(function(e){return e.id===i.id}),(c=new RTCPeerConnection).setRemoteDescription(i.oferta).then(function(){c.createAnswer().then(function(t){c.setLocalDescription(t).then(function(){e.signaling.send(JSON.stringify({evento:"resposta",resposta:t,id:n.id}))})})}),n.remoto=c,e.setState({inscricoes:a});break;case"resposta":a=e.state.inscricoes,(n=e.state.inscricoes.find(function(e){return e.id===i.id})).local.setRemoteDescription(i.resposta),e.setState({inscricoes:a});break;case"candidato":a=e.state.inscricoes,(n=e.state.inscricoes.find(function(e){return e.id===i.id})).remoto.addIceCandidate(i.candidato),e.setState({inscricoes:a});break;case"desconectado":a=e.state.inscricoes.filter(function(e){return e.id!==i.id}),e.setState({inscricoes:a});case"selecionado":i.id==e.state.id?navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){e.selecionado.current.srcObject=t,e.selecionado.current.play()}):(n=e.state.inscricoes.find(function(e){return e.id===i.id}))&&n.remoto&&(n.remoto.ontrack=function(t){e.selecionado.current.srcObject=t.streams[0],e.selecionado.current.play()})}},this.signaling.onclose=function(){console.log("fechado")}}}]),t}(n.Component),f=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"Monitoramento"},o.a.createElement("div",{className:"Monitoramento-Relatorios"},o.a.createElement("div",{className:"Monitoramento-Sinalizacoes"},o.a.createElement("div",{className:"Monitoramento-Cabecalho"},"Servidor de Sinaliza\xe7\xe3o"),o.a.createElement("table",{className:"Monitoramento-Acoes"},o.a.createElement("tbody",null,o.a.createElement("tr",{className:"Monitoramento-Item"},o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"red"}},"Rosa")),o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Acao"},"Conectado")),o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"black"}},"Conectado"))),o.a.createElement("tr",{className:"Monitoramento-Item"},o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"pink"}},"Carol")),o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Acao"},"Conectado")),o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"black"}},"Conectado"))),o.a.createElement("tr",{className:"Monitoramento-Item"},o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"black"}},"Servidor")),o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Acao"},"Cria\xe7\xe3o")),o.a.createElement("td",null,o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"red"}},"Rosa")))))),o.a.createElement("div",{className:"Monitoramento-Detalhes"},o.a.createElement("div",{className:"Monitoramento-Conteudo"},o.a.createElement("div",{className:"Monitoramento-Item"},o.a.createElement("b",null,"10")," Conectados"),o.a.createElement("div",{className:"Monitoramento-Item"},o.a.createElement("b",null,"Vinicius")," Selecionado")))),o.a.createElement("div",{className:"Monitoramento-Conectados"},o.a.createElement("div",{className:"Monitoramento-Item"},o.a.createElement("div",{className:"Monitoramento-Video"},o.a.createElement("img",{src:"https://picsum.photos/800/800"})),o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"pink"}},"Carol")),o.a.createElement("div",{className:"Monitoramento-Item"},o.a.createElement("div",{className:"Monitoramento-Video"},o.a.createElement("img",{src:"https://picsum.photos/800/800"})),o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"red"}},"Rosa")),o.a.createElement("div",{className:"Monitoramento-Item"},o.a.createElement("div",{className:"Monitoramento-Video"},o.a.createElement("img",{src:"https://picsum.photos/800/800"})),o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"green"}},"Lisa")),o.a.createElement("div",{className:"Monitoramento-Item"},o.a.createElement("div",{className:"Monitoramento-Video"},o.a.createElement("img",{src:"https://picsum.photos/800/800"})),o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"gray"}},"Alan")),o.a.createElement("div",{className:"Monitoramento-Item"},o.a.createElement("div",{className:"Monitoramento-Video"},o.a.createElement("img",{src:"https://picsum.photos/800/800"})),o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"orange"}},"Renata")),o.a.createElement("div",{className:"Monitoramento-Item"},o.a.createElement("div",{className:"Monitoramento-Video"},o.a.createElement("img",{src:"https://picsum.photos/800/800"})),o.a.createElement("div",{className:"Monitoramento-Conectado",style:{backgroundColor:"blue"}},"Vinicius"))))}}]),t}(n.Component),b=function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).call(this,e))}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return o.a.createElement(u.a,null,o.a.createElement("div",{className:"App"},o.a.createElement(v.a,{path:"/cadastro",component:h}),o.a.createElement(v.a,{path:"/conferencia",component:p}),o.a.createElement(v.a,{path:"/monitoramento",component:f})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(21);i.a.render(o.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[13,2,1]]]);
//# sourceMappingURL=main.50b4a5cb.chunk.js.map